
////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2017, Perry L Miller IV
//  All rights reserved.
//
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
//
//  Application view module.
//
////////////////////////////////////////////////////////////////////////////////

import "./AppView.css";

import Bracket from "./Bracket";

import React from "react";

import lodash from "lodash";


////////////////////////////////////////////////////////////////////////////////
//
//  Application class.
//
////////////////////////////////////////////////////////////////////////////////

class AppView extends React.Component
{
  constructor ( props )
  {
    // Call the base class's constructor.
    super ( props );

    // Private data members.
    this.state = {
      width: window.innerWidth,
      height: window.innerHeight
    };
  }

  render()
  {
    return this._render();
  }
}


////////////////////////////////////////////////////////////////////////////////
//
//  Called after the component mounted.
//
////////////////////////////////////////////////////////////////////////////////

AppView.prototype.componentDidMount = function()
{
  window.addEventListener ( "resize", lodash.bind ( this._updateDimensions, this ) );
};


////////////////////////////////////////////////////////////////////////////////
//
//  Called before the component is unmounted.
//
////////////////////////////////////////////////////////////////////////////////

AppView.prototype.componentWillUnmount = function()
{
  window.removeEventListener ( "resize", lodash.bind ( this._updateDimensions, this ) );
};


////////////////////////////////////////////////////////////////////////////////
//
//  Update the dimensions.
//
////////////////////////////////////////////////////////////////////////////////

AppView.prototype._updateDimensions = function ( event )
{
  this.setState ( {
    width: window.innerWidth,
    height: window.innerHeight
  } );
};


////////////////////////////////////////////////////////////////////////////////
//
//  Render.
//
////////////////////////////////////////////////////////////////////////////////

AppView.prototype._render = function()
{
  const state = this.state;
  const width = state.width - 0; // Subtract width of scroll bar until you enable horizontal scroll.
  const height = state.height - 0;

  const props = {
    bracket: this.props.tournament.divisions.Open["150"].bracket.winners,
    players: this.props.tournament.players,
    width: width,
    height: height,
    margin: {
      left: 40,
      right: 40,
      top: 50,
      bottom: 50
    }
  };

  return (
    <div className = "app_container">
      <Bracket { ... props } />
    </div>
  );
};


////////////////////////////////////////////////////////////////////////////////
//
//  The end of the module.
//
////////////////////////////////////////////////////////////////////////////////

export default AppView;
